<!DOCTYPE html>
<html> 
<head> 
<title>index_three</title> 
<script type="text/javascript" src="jquery-1.6.4.js"></script>
<link rel="stylesheet" type="text/css" href="light.css">
</head>
<body > 

<!-- <div class="sky"></div> -->

<!-- <div class="scenes">
	<div class="scene scene-city"></div>
	<div class="scene scene-hill"></div>
	<div class="scene scene-land"></div>
	<div class="scene scene-desert"></div>
	<div class="scene scene-sea"></div> 
</div>	
 -->
<canvas id="front" ></canvas>
<canvas id="back" ></canvas>

<div class="sun"></div>

<script type="text/javascript">


	var $body = $("body");

	var $scenes = $(".scenes");
	var $sceneCity = $(".scene-city");
	var $sceneHill = $(".scene-hill");
	var $sceneLand = $(".scene-land");
	var $sceneDesert = $(".scene-desert");
	var $sceneSea = $(".scene-sea");

	var clientW = window.innerWidth;
	var clientH = window.innerHeight;

	$body.css({"font-size":clientW/100+"px","width":clientW+"px","height":clientH+"px"});

	$scenes.height(clientH);


	//绘制canvas背景，并填充渐变色
	function drawFront() {
	  var canvas = document.getElementById('front');
	  canvas.width = clientW*5;
	  canvas.height = clientH;

	  // 缩放比率
	  var ratioX = clientW/1000;
	  var ratioY = clientH/1000;

	  if (canvas.getContext) {
	    var ctx = canvas.getContext('2d');
	    ctx.beginPath();

	    var origin = [1161*ratioX, 660*ratioY];

	    ctx.moveTo (origin[0], origin[1]);
	    ctx.moveTo (1161, 660);
		ctx.bezierCurveTo(35, 46.5, 50, 134.5, 205, 134.5);
		ctx.bezierCurveTo(360,134.5,1051, 371, 969, 376);
	    // var result;


	    var changePoint = function (arr,i){
	    	debugger;
	    	if (arr.length==6) {
			    arr = arr.map(function(value, index){
			    	debugger;
			    	return value + origin[(index % 2 == 0) ? 0 : 1];
			    })
	    	}else{
	    		if(arr[6]=="C"){
				    arr.length = 6;
	    		}
	    		if (arr[6]=="S") {
	    			var prevArr = newPointList[i-1];
				    arr = arr.map(function(value, index){
				    	if (index == 2|3|4|5) {
				    		return value + origin[(index % 2 == 0) ? 0 : 1];
				    	}
				    	if (index == 6) {
				    		return v;
				    	};
				    })
				    arr[0] = 2*prevArr[4]-prevArr[2];
				    arr[1] = 2*prevArr[5]-prevArr[3]
				    arr.length = 6;
	    		};
	    	}
	    	origin[0] = arr[4];
	    	origin[1] = arr[5];
	    	return arr;
	    }

	    var pointList = [[237, 2, 474, 4, 711, 6],[86, 1, 261, 38, 328, -25],[76, -71, 135, -162, 189, -249],[105, -175, 117, 286, 174, 267],[63, -21, 81, -226, 91, -281],[6, -33, 25, -234, 65, -241],[24, -5, 83, 402, 103, 441],[52, 102, 293, 135, 393, 135],[189, -2, 378, -3, 566, -4],[149, -1, 380, 41, 510, -51],[52, -37, 64, -110, 124, -137],[37, -17, 75, -10, 109, 9],[41, 23, 63, -4, 101, -22],[146, -68, 193, 161, 329, 154],[61, -3, 83, -61, 136, -77],[73, -22, 154, 53, 204, 95],[102, 85, 304, 229, 443, 229],[-1526, 0, -3052, 0, -4578, 0],[1,917,3,835,4,752,"C"]];

		[35, 46.5, 50, 134.5, 205, 134.5]

		// var pointList = [[-82, 2.7, -74, 197, 7, 196],[,,1051, 371, 969, 376,"S"]]


	    // var newPointList=[];


	    var pointToCurve = function(pointlist,ctx) {
	 	    pointlist.map(function(value,index){
		    	var innerArr = value.map(function(v,i){
	 	    		debugger;
		    		if ( i<=5 ) {
		    			return (i % 2 == 0) ? parseInt(v*ratioX) : parseInt(v*ratioY);
		    		}else{
		    			return v;
		    		}
		    	})
		    	// newPointList[index] = innerArr;
		    	var arr = changePoint(innerArr,index);
		    	newPointList[index] = arr;
	    		ctx.bezierCurveTo(arr[0], arr[1], arr[2], arr[3], arr[4], arr[5]);
		    	return arr;
		    })
	    }


	    pointToCurve(pointList,ctx);




		// var grd = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);

	 //    grd.addColorStop(0, '#000'); 
	 //    grd.addColorStop(.16, '#232a35'); 
	 //    grd.addColorStop(.19, '#232a35');
	 //    grd.addColorStop(.22, '#006d5f');
	 //    grd.addColorStop(.33, '#038b79');
	 //    grd.addColorStop(.48, '#038b79');
	 //    grd.addColorStop(.50, '#00bf48');
	 //    grd.addColorStop(.65, '#00bf48');
	 //    grd.addColorStop(.74, '#984f00');
	 //    ctx.fillStyle = grd;


	    ctx.fill();

	  }






	};
	drawFront();

	function drawBack(){
		var canvas = document.getElementById('back');
		canvas.width = clientW*5;
		canvas.height = clientH;
		if (canvas.getContext) {
			var ctx = canvas.getContext('2d');
			ctx.rect(0,canvas.height*4/5,canvas.width,canvas.height/5);
			ctx.fill();

		}
	}

	// drawBack();

	console.log("frontWidth="+$('#front').width());

	// var i = setInterval("console.log($('#front').css('left'))",1000);

</script>


</body>
</html> 


