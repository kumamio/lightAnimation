<!DOCTYPE html>
<html> 
<head> 
<title>index_three</title> 
<script type="text/javascript" src="jquery-1.6.4.js"></script>
<link rel="stylesheet" type="text/css" href="lightandcolor.css">
<script type="text/javascript" src="utils.js"></script>
</head>
<body > 
<canvas id="cover"></canvas>
<!-- <div class="scenes clearfix"> -->
	<!-- <div class="scene scene_city"> -->
		<!-- <canvas id="scene_city"></canvas> -->
		<!-- <div class="shadow"></div> -->
	<!-- </div> -->
<!-- 	<div class="scene scene_country">
		<canvas id="scene_country"></canvas>
	</div> -->

<!-- </div> -->

<script type="text/javascript">

	var clientW = window.innerWidth;
	var clientH = window.innerHeight;
	var ratioX =  clientW/2000;
	var ratioY = clientH/1000;

	var cover=document.getElementById("cover");

	$("body").css({"font-size":clientW/100+"px","width":clientW+"px","height":clientH+"px"});

	if (cover) {

		cover.width = clientW;
		cover.height = clientH;

		var ctx = cover.getContext("2d");
		ctx.moveTo(clientW/2,clientH/2);
		ctx.beginPath();
		ctx.fillStyle = '#444';
		ctx.fillRect(0,0,clientW,clientW);
		ctx.textAlign="center";

		ctx.font=clientW/4+"px Impact";
		ctx.textBaseline="middle";
		ctx.globalCompositeOperation = 'destination-out';
		ctx.shadowColor = "rgba(0,0,0,.5)";
		ctx.fillText("color",clientW/2,clientH/2);
		ctx.fillStyle = '#000';
		ctx.globalCompositeOperation = 'luminosity';




	function playSceneCity(){
		var city=document.getElementById("scene_city");
		city.width = clientW;
		city.height = clientH;
		var ctx = city.getContext("2d");

		(function drawScene() {
			light=light +10;
			
			// debugger;

			var newHsl = function(arr) {
				return "hsl("+arr[0]+","+arr[1]+"%,"+parseInt(light/100*arr[2])+"% )"
			}
			
			var grassColor1 = [73,100,31];
			var grassColor2 = [91,88,28];

			if (light<=100) {
				
				var grassColor1 = newHsl(grassColor1);
				var grassColor2 = newHsl(grassColor2);

				var grd = ctx.createLinearGradient(0,clientH,clientW, clientH);
				grd.addColorStop(0,   grassColor1);
				grd.addColorStop(0.2, grassColor1);
				grd.addColorStop(0.2, grassColor2);
				grd.addColorStop(0.4, grassColor2);
				grd.addColorStop(0.4, grassColor1);
				grd.addColorStop(0.6, grassColor1);
				grd.addColorStop(0.6, grassColor2);
				grd.addColorStop(0.8, grassColor2);
				grd.addColorStop(0.8, grassColor1);
				grd.addColorStop(1,   grassColor1);
				ctx.fillStyle = grd;
				ctx.fillRect(0,0.8*clientH,clientW,clientH);



				var drawRect = function(x,y,h,s,l,width,height,outlight){
					if (outlight) {
						// debugger;
						ctx.shadowColor = "hsla("+h+","+s+","+l+","+".5)";
						ctx.shadowOffsetX = 0;
						ctx.shadowOffsetY = 0;
						ctx.shadowBlur = 5;
						ctx.fillStyle = "hsl("+h+", "+s+"%, "+ l*(80-light)/100+ "%)";
					}else{
						ctx.fillStyle = "hsl("+h+", "+s+"%, "+ l*light/100+ "%)";
					}
					ctx.fillRect(x*ratioX,y*ratioY,width*ratioX,height*ratioY);

				}

				drawRect(366,313,0,0,35,237,490);
				drawRect(705,414,0,0,35,186,386);



				var drawWindows = function(x,y,width,height){
					// debugger;
					for (var j = 0; j < 4; j++) {
						for (var i = 0; i < 2; i++) {
							drawRect(x+width*2*i,y+height*1.5*j,56,94,50,width,height,true)
						};

					}
				}
				drawWindows(418,365,44,70);
				drawWindows(749,453,33,54);

				setTimeout(function(){
					requestAnimationFrame(drawScene);
				},100)
			}
		})();



	}




		cover.addEventListener('mousedown',function(event){
			var x = event.pageX;
			var y = event.pageY;
			var radius = 0;
			//amazing
			(function drawCircle() {
				radius = (radius+1)*1.15;
				ctx.arc(event.pageX, event.pageY, radius, 0, 2 * Math.PI);
				ctx.fill();
				if (radius<=clientW) {
					setTimeout(function(){
						requestAnimationFrame(drawCircle);
					},10)
				}else{
					playSceneCity();
				}
			})();

		},false)

	};

	var light = 0;





</script>


</body>
</html> 


